<form onunloadCancelJobs="true" stylesheet="load.css" script="load.js" theme="dark">
  <label>SH - 05 - Audit Users Activity - Dashboard - v1</label>
  <description>GMC Audit Users Activity Dashboard</description>
  <search id="splunk_sh_05_audit_users_dashboard_v1">
    <query>| from lookup:splunk_index_audit_user_login_tracker_sh_kv_store_lookup 
| fields User Earliest_Access Latest_Access Login_Source Splunk_Instance OS_Name OS_Version Browser_Name Browser_Version
| fillnull value="9999999" Latest_Access Earliest_Access
| `get_instance_roles(Splunk_Instance)` 
| `get_shcluster_label(Splunk_Instance)` 
| eval Days_Latest_Access = round((now() - Latest_Access) / 86400 )
| `strftime_format(Earliest_Access)` 
| `strftime_format(Latest_Access)` 
| `get_identity_info(User)`
| `get_geo_info(emp_city,emp_region1,emp_country)`
| `fillnull_identity_info`
| `strftime_format(last_successful_login)`
| `set_geo_defaults` 
| eval shcluster_label = if(isnull(shcluster_label), Splunk_Instance, shcluster_label) 
| `get_iplocation_info2(Login_Source)`
| stats 
    values(*) as * by User Login_Source
| fillnull value="undefined" emp_lob1 emp_lob2 emp_lob3 vendor_name splunk_role_map ldap_group_name ldap_group_type
| search shcluster_label="$shcluster_label$" emp_name="*$emp_name$*" emp_manager="$emp_manager$" emp_status="$emp_status$" emp_type IN ($emp_type$) Days_Latest_Access &gt;= $Days_Latest_Access1$ Days_Latest_Access &lt;= $Days_Latest_Access2$ emp_dep="$emp_dep$" emp_lob1="$emp_lob1$" emp_lob2="$emp_lob2$" emp_lob3="$emp_lob3$" emp_title="$emp_title$" emp_cc="$emp_cc$" emp_city="$emp_city$" emp_region1="$emp_region1$" emp_country="$emp_country$" Splunk_Roles="$Splunk_Roles$" Splunk_Instance="$Splunk_Instance$" User="$User$" User!="$User2$" Login_Source="*$Login_Source$*" splunk_role_map="$splunk_role_map$" ldap_group_name="$ldap_group_name$" ldap_group_type="$ldap_group_type$" vendor_name="$vendor_name$"</query>
  </search>
  <search id="splunk_sh_05_audit_users_dashboard_v1_2">
    <query>index=`gmc_setup_summary_index` search_name=splunk_audit_user_login_idx_summary_tracker
| fields _time User Splunk_Instance Login_Source OS_Name OS_Version Browser_Name Browser_Version 
| foreach Splunk_Instance Login_Source OS_Name OS_Version Browser_Name Browser_Version 
    [ makemv delim="|" &lt;&lt;FIELD&gt;&gt; ]
| `get_shcluster_label(Splunk_Instance)` 
| `get_identity_info(shcluster_label,User)` | `get_identity_info(User)` | `fillnull_identity_info`
| fillnull value="undefined" OS_Name OS_Version Browser_Name Browser_Version
| search shcluster_label="$shcluster_label2$" User="$User3$" User!="$User4$" OS_Name="$OS_Name_tok$" OS_Version="$OS_Version_tok$" Browser_Name="$Browser_Name_tok$" Browser_Version="$Browser_Version_tok$"</query>
    <earliest>$TimeRangePkr.earliest$</earliest>
    <latest>$TimeRangePkr.latest$</latest>
  </search>
  <fieldset submitButton="true" autoRun="true"></fieldset>
  <row>
    <panel id="panel_accordion_togglepanel_false_01" depends="$gadget_lib_loaded$">
      <title>1. Basic Filters</title>
      <input type="dropdown" token="shcluster_label" searchWhenChanged="true">
        <label>1. Splunk SH (Cluster/Instance)</label>
        <fieldForLabel>shcluster_label</fieldForLabel>
        <fieldForValue>shcluster_label</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by shcluster_label</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
        <label>2. Splunk Roles</label>
        <fieldForLabel>Splunk_Roles</fieldForLabel>
        <fieldForValue>Splunk_Roles</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Splunk_Roles</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Instance" searchWhenChanged="true">
        <label>3. Splunk Instance</label>
        <fieldForLabel>Splunk_Instance</fieldForLabel>
        <fieldForValue>Splunk_Instance</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Splunk_Instance</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Days_Latest_Access2" searchWhenChanged="true">
        <label>4. Days Since Latest Access (Less Than or Equal)</label>
        <fieldForLabel>Days_Latest_Access_Display</fieldForLabel>
        <fieldForValue>Days_Latest_Access</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Days_Latest_Access 
| sort Days_Latest_Access
| `get_latest_access_human(Days_Latest_Access)`</query>
        </search>
        <choice value="9999999">Any</choice>
        <default>9999999</default>
        <initialValue>9999999</initialValue>
      </input>
      <input type="dropdown" token="Days_Latest_Access1" searchWhenChanged="true">
        <label>5. Days Since Latest Access (More Than or Equal)</label>
        <fieldForLabel>Days_Latest_Access_Display</fieldForLabel>
        <fieldForValue>Days_Latest_Access</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Days_Latest_Access 
| sort Days_Latest_Access
| `get_latest_access_human(Days_Latest_Access)`</query>
        </search>
        <choice value="-1">Any</choice>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="dropdown" token="splunk_role_map" searchWhenChanged="true">
        <label>6. Splunk Role Maping</label>
        <choice value="*">All</choice>
        <fieldForLabel>splunk_role_map</fieldForLabel>
        <fieldForValue>splunk_role_map</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by splunk_role_map</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="ldap_group_name" searchWhenChanged="true">
        <label>7. LDAP Group Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>ldap_group_name</fieldForLabel>
        <fieldForValue>ldap_group_name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by ldap_group_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="ldap_group_type" searchWhenChanged="true">
        <label>8. LDAP Group Type</label>
        <choice value="*">All</choice>
        <fieldForLabel>ldap_group_type</fieldForLabel>
        <fieldForValue>ldap_group_type</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by ldap_group_type</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Login_Source" searchWhenChanged="true">
        <label>9. Login Source</label>
        <fieldForLabel>Login_Source</fieldForLabel>
        <fieldForValue>Login_Source</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Login_Source</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="Login_Source" searchWhenChanged="true">
        <label>9. Login Source (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_02" depends="$gadget_lib_loaded$">
      <title>2. Identity Filters</title>
      <input type="dropdown" token="User" searchWhenChanged="true">
        <label>1.1 Identity (User)</label>
        <fieldForLabel>User</fieldForLabel>
        <fieldForValue>User</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by User</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="User" searchWhenChanged="true">
        <label>1.2 Identity (User) (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="User2" searchWhenChanged="true">
        <label>1.3 Identity (User) (Does not contain)</label>
        <default>int_*</default>
        <initialValue>int_*</initialValue>
      </input>
      <input type="dropdown" token="emp_name" searchWhenChanged="true">
        <label>2.1 Full Name</label>
        <fieldForLabel>emp_name</fieldForLabel>
        <fieldForValue>emp_name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_name</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="emp_name" searchWhenChanged="true">
        <label>2.2 Full Name (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_title" searchWhenChanged="true">
        <label>3. Employee Title</label>
        <fieldForLabel>emp_title</fieldForLabel>
        <fieldForValue>emp_title</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_title</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="multiselect" token="emp_type" searchWhenChanged="false">
        <label>4. Employee Type</label>
        <fieldForLabel>emp_type</fieldForLabel>
        <fieldForValue>emp_type</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_type</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
        <valuePrefix>"</valuePrefix>
        <valueSuffix>"</valueSuffix>
        <delimiter> ,</delimiter>
      </input>
      <input type="dropdown" token="emp_status" searchWhenChanged="true">
        <label>5. Employee Status</label>
        <fieldForLabel>emp_status</fieldForLabel>
        <fieldForValue>emp_status</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_status</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_lob1" searchWhenChanged="true">
        <label>6.1 Line of Business 1</label>
        <fieldForLabel>emp_lob1</fieldForLabel>
        <fieldForValue>emp_lob1</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob1</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_lob2" searchWhenChanged="true">
        <label>6.2 Line of Business 2</label>
        <fieldForLabel>emp_lob2</fieldForLabel>
        <fieldForValue>emp_lob2</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob2</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_lob3" searchWhenChanged="true">
        <label>6.3 Line of Business 3</label>
        <fieldForLabel>emp_lob3</fieldForLabel>
        <fieldForValue>emp_lob3</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob3</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_dep" searchWhenChanged="true">
        <label>7. Employee Department</label>
        <fieldForLabel>emp_dep</fieldForLabel>
        <fieldForValue>emp_dep</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_dep</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_cc" searchWhenChanged="true">
        <label>8. Cost Center</label>
        <fieldForLabel>emp_cc</fieldForLabel>
        <fieldForValue>emp_cc</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_cc</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="vendor_name" searchWhenChanged="true">
        <label>9. Vendor Name</label>
        <fieldForLabel>vendor_name</fieldForLabel>
        <fieldForValue>vendor_name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by vendor_name</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_manager" searchWhenChanged="true">
        <label>10. Manager Name</label>
        <fieldForLabel>emp_manager</fieldForLabel>
        <fieldForValue>emp_manager</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_manager</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_city" searchWhenChanged="true">
        <label>11. City</label>
        <fieldForLabel>emp_city</fieldForLabel>
        <fieldForValue>emp_city</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_city</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_region1" searchWhenChanged="true">
        <label>12. Region</label>
        <fieldForLabel>emp_region1</fieldForLabel>
        <fieldForValue>emp_region1</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_region1</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_country" searchWhenChanged="true">
        <label>13.  Country</label>
        <fieldForLabel>emp_country</fieldForLabel>
        <fieldForValue>emp_country</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_country</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_location" searchWhenChanged="true">
        <label>14.  Employee Location</label>
        <fieldForLabel>emp_location</fieldForLabel>
        <fieldForValue>emp_location</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_location</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_03" depends="$gadget_lib_loaded$">
      <title>3. User Logon Activity Table (From KV Store Tracking)</title>
      <table depends="$Login_Source$,$emp_dep$,$emp_lob1$,$User$,$emp_city$,$emp_region1$,$emp_country$,$emp_type$">
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| `get_latest_access_human(Days_Latest_Access)` 
| table User emp_name emp_title shcluster_label Login_Source Latest_Access Days_Latest_Access_Display Earliest_Access Days_Since_Earliest_Login last_successful_login emp_type emp_status emp_lob1 emp_lob2 emp_lob3 emp_dep emp_cc emp_manager emp_location emp_city emp_region1 emp_country OS_Name OS_Version Browser_Name Browser_Version 
| sort 0 - Latest_Access 
| `rename_common_fields` 
| `rename_identity_fields`</query>
        </search>
        <option name="count">7</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="number" field="Days Since Last Login">
          <option name="precision">0</option>
          <option name="unit">Days</option>
        </format>
        <drilldown>
          <unset token="form.Login_Source"></unset>
          <unset token="form.emp_dep"></unset>
          <unset token="form.emp_lob1"></unset>
          <unset token="form.User"></unset>
          <unset token="form.emp_city"></unset>
          <unset token="form.emp_region1"></unset>
          <unset token="form.emp_country"></unset>
          <unset token="form.emp_type"></unset>
        </drilldown>
      </table>
      <single>
        <title>Total Number of Users Accessing the Platform</title>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <option name="rangeColors">["0x53a051","0x006d9c"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">none</option>
        <option name="unit">Users</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_2" depends="$gadget_lib_loaded$">
      <title>2. Drilldown By Employee</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by User| fields - count</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="emp_cc">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="emp_cc">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="count">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <drilldown>
          <set token="form.User">$row.User$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_4" depends="$gadget_lib_loaded$">
      <title>3. Drilldown By Employee Type</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_type| fields - count</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <drilldown>
          <set token="form.emp_type">$row.emp_type$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_5" depends="$gadget_lib_loaded$">
      <title>4. Drilldown By Employee LOB</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob1| fields - count
| where emp_lob1!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <drilldown>
          <set token="form.emp_lob1">$row.emp_lob1$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_6" depends="$gadget_lib_loaded$">
      <title>5. Drilldown By  Employee Department</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_dep| fields - count
| where emp_dep!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="count">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Rank">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Employee Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.emp_dep">$row.emp_dep$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_7" depends="$gadget_lib_loaded$">
      <title>6. Drilldown By Login Source (Client IP)</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats last(City) AS City last(Region) AS Region last(Country) AS Country by Login_Source 
| where Login_Source!="unknown" AND Login_Source!=""</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="Login Sources">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="# of Login Sources">
          <option name="precision">0</option>
        </format>
        <format type="color" field="# of Login Sources">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <drilldown>
          <set token="form.Login_Source">$row.Login_Source$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_8" depends="$gadget_lib_loaded$">
      <title>7. Drilldown By Employee City</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_city
| fields - count
| where emp_city!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <drilldown>
          <set token="form.emp_city">$row.emp_city$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_9" depends="$gadget_lib_loaded$">
      <title>8. Drilldown By Employee Region/State</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_region1| fields - count
| where emp_region1!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <drilldown>
          <set token="form.emp_region1">$row.emp_region1$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_10" depends="$gadget_lib_loaded$">
      <title>9. Drilldown By Employee Country</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_country| fields - count
| where emp_country!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">false</option>
        <drilldown>
          <set token="form.emp_country">$row.emp_country$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_122" depends="$gadget_lib_loaded$">
      <title>10. Reporting Pie Chart</title>
      <input type="dropdown" token="split_by_tok_3" searchWhenChanged="true">
        <label>1. Split By</label>
        <choice value="emp_lob1">Employee LOB</choice>
        <choice value="emp_lob2">Employee LOB2</choice>
        <choice value="emp_lob3">Employee LOB3</choice>
        <choice value="emp_dep">Employee Department</choice>
        <choice value="emp_type">Employee Type</choice>
        <choice value="emp_status">Employee Status</choice>
        <choice value="emp_city">Employee City</choice>
        <choice value="emp_region1">Employee Region1</choice>
        <choice value="emp_region2">Employee Region2</choice>
        <choice value="emp_country">Employee Country</choice>
        <default>emp_dep</default>
        <initialValue>emp_dep</initialValue>
      </input>
      <chart>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by $split_by_tok_3$</query>
        </search>
        <option name="charting.backgroundColor">FFFF31</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.showPercent">1</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="height">700</option>
        <option name="refresh.display">progressbar</option>
      </chart>
      <single>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats Dc($split_by_tok_3$)</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="rangeColors">["0x53a051","0x53a051"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_12" depends="$gadget_lib_loaded$">
      <title>11. User Login Over Time (From Summary Indexing Tracking)</title>
      <input type="dropdown" token="shcluster_label2" searchWhenChanged="true">
        <label>1. Splunk SH (Cluster/Instance)</label>
        <fieldForLabel>shcluster_label</fieldForLabel>
        <fieldForValue>shcluster_label</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by shcluster_label</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="time" token="TimeRangePkr" searchWhenChanged="true">
        <label>2. Time Range</label>
        <default>
          <earliest>-7d@h</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="span_period" searchWhenChanged="true">
        <label>3. Span Period</label>
        <default>span=1d</default>
        <choice value="">Automatic</choice>
        <choice value="span=1s">1 seconds</choice>
        <choice value="span=5s">5 seconds</choice>
        <choice value="span=10s">10 seconds</choice>
        <choice value="span=15s">15 seconds</choice>
        <choice value="span=30s">30 seconds</choice>
        <choice value="span=1m">1 minute</choice>
        <choice value="span=5m">5 minutes</choice>
        <choice value="span=10m">10 minutes</choice>
        <choice value="span=15m">15 minutes</choice>
        <choice value="span=30m">30 minutes</choice>
        <choice value="span=45m">45 minutes</choice>
        <choice value="span=1h">1 hour</choice>
        <choice value="span=2h">2 hours</choice>
        <choice value="span=3h">3 hours</choice>
        <choice value="span=4h">4 hours</choice>
        <choice value="span=6h">6 hours</choice>
        <choice value="span=8h">8 hours</choice>
        <choice value="span=12h">12 hours</choice>
        <choice value="span=1d">1 day</choice>
        <choice value="span=1w">1 week</choice>
        <choice value="span=1mon">1 month</choice>
        <choice value="span=12mon">1 year</choice>
        <initialValue>span=1d</initialValue>
      </input>
      <input type="dropdown" token="OS_Name_tok" searchWhenChanged="true">
        <label>4. OS Name</label>
        <fieldForLabel>OS_Name</fieldForLabel>
        <fieldForValue>OS_Name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by OS_Name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="OS_Version_tok" searchWhenChanged="true">
        <label>5. OS Version</label>
        <fieldForLabel>OS_Version</fieldForLabel>
        <fieldForValue>OS_Version</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by OS_Version</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="Browser_Name_tok" searchWhenChanged="true">
        <label>6. Browser Name</label>
        <fieldForLabel>Browser_Name</fieldForLabel>
        <fieldForValue>Browser_Name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by Browser_Name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="Browser_Version_tok" searchWhenChanged="true">
        <label>7. Browser Version</label>
        <fieldForLabel>Browser_Version</fieldForLabel>
        <fieldForValue>Browser_Version</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by Browser_Version</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="User3" searchWhenChanged="true">
        <label>8. User</label>
        <fieldForLabel>User</fieldForLabel>
        <fieldForValue>User</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by User</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="split_by_tok_1" searchWhenChanged="true">
        <label>9. Split By</label>
        <choice value="By User">User</choice>
        <choice value="By OS_Name">OS Name</choice>
        <choice value="By Browser_Name">Browser Name</choice>
        <choice value="By shcluster_label">Search Cluster Label</choice>
        <choice value="By Splunk_Instance">Search Head</choice>
        <choice value="By emp_lob1">Employee LOB</choice>
        <choice value="By emp_dep">Employee Department</choice>
        <choice value="By emp_type">Employee Type</choice>
        <choice value="By Login_Source">Login Source</choice>
        <fieldForLabel>split_by_tok_1</fieldForLabel>
        <fieldForValue>split_by_tok_1</fieldForValue>
        <default>By shcluster_label</default>
        <initialValue>By shcluster_label</initialValue>
      </input>
      <input type="text" token="User3" searchWhenChanged="true">
        <label>10. User (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="User4" searchWhenChanged="true">
        <label>10. User (Does not Contains)</label>
        <default>system</default>
        <initialValue>system</initialValue>
      </input>
      <input type="text" token="top_tok" searchWhenChanged="true">
        <label>4. Timechart IN top:</label>
        <default>10</default>
        <initialValue>10</initialValue>
      </input>
      <chart>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| timechart useother=f usenull=f fixedrange=f limit=0 $span_period$
    Dc(User) As Num_Users $split_by_tok_1$ 
    Where Max in top$top_tok$</query>
        </search>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.backgroundColor">FFFF31</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.stackMode">stacked100</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">1</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="charting.seriesColors">[#09568d, #457725, #e06000, #964f8e, #a6001a, #664228, #ffbb00, #4F86F7, #84DE02, #FF00CC, #5E8C31, #214FC6, #5DADEC, #FA5B3D, #58427C]</option>
        <option name="height">700</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_13" depends="$gadget_lib_loaded$">
      <title>12. Geographical Location by User rendered on a world map</title>
      <input type="dropdown" token="split_by_tok_2" searchWhenChanged="true">
        <label>Split By</label>
        <choice value="User">Identity</choice>
        <choice value="emp_name">Employee Name</choice>
        <fieldForLabel>split_by_tok_2</fieldForLabel>
        <fieldForValue>split_by_tok_2</fieldForValue>
        <default>emp_name</default>
        <initialValue>emp_name</initialValue>
      </input>
      <map>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| fields emp_name User emp_city emp_region1 emp_country Login_Source emp_lat emp_lon 
| mvexpand emp_lat 
| mvexpand emp_lon 
| eval emp_region1 = if(emp_region1="no-geo-info", emp_country, emp_region1) 
| strcat $split_by_tok_2$ . " (" . emp_city . ", " . emp_region1 . ")" split_by 
| geostats latfield=emp_lat longfield=emp_lon globallimit=0 locallimit=0 maxzoomlevel=18
    count by split_by</query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">1200</option>
        <option name="mapping.data.maxClusters">100</option>
        <option name="mapping.map.center">(41.64,-93.49)</option>
        <option name="mapping.map.zoom">4</option>
        <option name="mapping.markerLayer.markerMaxSize">50</option>
        <option name="mapping.markerLayer.markerMinSize">20</option>
        <option name="mapping.markerLayer.markerOpacity">1</option>
        <option name="mapping.showTiles">1</option>
        <option name="mapping.tileLayer.maxZoom">19</option>
        <option name="mapping.tileLayer.minZoom">0</option>
        <option name="mapping.tileLayer.url">http://mt1.google.com/vt/lyrs=y&amp;x={x}&amp;y={y}&amp;z={z}</option>
        <option name="mapping.type">marker</option>
        <option name="refresh.display">none</option>
      </map>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_3" depends="$gadget_lib_loaded$">
      <title>13. Associated GMC Job(s)</title>
      <html>
            <ol>
               <li>
                  <a href="/app/global_monitoring_console/search?s=splunk_rest_identities_kv_store_lookup_gen" target="_blank" rel="noopener">GMC Identities Gen Job</a>
               </li>
               <li>
                  <a href="/app/global_monitoring_console/search?s=splunk_index_audit_user_login_tracker_sh_kv_store_lookup_tracker" target="_blank" rel="noopener">Track Users Activity (KV Store) (every 5 minutes)</a>
               </li>
               <li>
                  <a href="/app/global_monitoring_console/search?s=splunk_audit_user_login_idx_summary_tracker" target="_blank" rel="noopener">Track Users Activity (Summary Index) (every 5 minutes)</a>
               </li>
               <li>
                  <a href="/app/global_monitoring_console/search?s=splunk_identities_custom_sh_kv_store_gap_lookup_gen" target="_blank" rel="noopener">Append new users to Custom Identities Table</a>
               </li>
            </ol>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=nobody&amp;namespace=global_monitoring_console&amp;lookup=splunk_identities_custom_kv_store&amp;type=kv">
                     View Custom Identities KV Store
                     <i class="icon-data icon-modal-medium icon-color-searchfu m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-severe m-left"/>
                  </a>
               </div>
            </div>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=nobody&amp;namespace=global_monitoring_console&amp;lookup=splunk_rest_identities_kv_store&amp;type=kv">
                     View Identities KV Store
                     <i class="icon-data icon-modal-medium icon-color-searchfu m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-severe m-left"/>
                  </a>
               </div>
            </div>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=nobody&amp;namespace=global_monitoring_console&amp;lookup=splunk_index_audit_user_login_tracker_sh_kv_store&amp;type=kv">
                     View User Activity Tracker KV Store
                     <i class="icon-data icon-modal-medium icon-color-brandColorD40 m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-brandColorD40 m-left"/>
                  </a>
               </div>
            </div>
         </html>
    </panel>
  </row>
</form>