<form onunloadCancelJobs="true" stylesheet="load.css" script="load.js" theme="dark">
  <label>SH - 05 - Audit Users Activity - Cloud Dashboard - v1</label>
  <description>GMC Audit Users Activity Dashboard for Splunk Cloud</description>
  <search id="splunk_sh_05_audit_users_dashboard_v1">
    <query>| from lookup:splunk_index_audit_user_login_tracker_sh_kv_store_lookup 
| fields User Earliest_Access Latest_Access Login_Source Splunk_Instance OS_Name OS_Version Browser_Name Browser_Version
| fillnull value="9999999" Latest_Access Earliest_Access
| `get_instance_roles(Splunk_Instance)` 
| `get_shcluster_label(Splunk_Instance)` 
| eval Days_Latest_Access = round((now() - Latest_Access) / 86400 )
| `strftime_format(Earliest_Access)` 
| `strftime_format(Latest_Access)` 
| `get_identity_info(shcluster_label,User)`
| `set_geo_defaults` 
| fields shcluster_label User Earliest_Access Latest_Access Login_Source Splunk_Roles Splunk_Instance first last emp_name email phone managedBy bunit startDate endDate work_city work_region work_country work_lat work_long emp_ttl emp_lob emp_dep emp_type emp_status emp_cc emp_loc emp_floor Contractor_Expiration Days_Latest_Access Days_Since_Earliest_Login splunk_role_map ldap_group_name ldap_group_type OS_Name OS_Version Browser_Name Browser_Version
| eval shcluster_label = if(isnull(shcluster_label), Splunk_Instance, shcluster_label) 
| `get_geo_info(work_city,work_region,work_country)`
| `get_iplocation_info2(Login_Source)`
| stats 
    values(*) as * by User
`gmc_comment("| fillnull value="undefined" emp_name managedBy emp_status emp_type emp_dep emp_lob emp_ttl emp_cc work_city work_region work_country")`
| fillnull value="undefined"
| search shcluster_label="$shcluster_label$" emp_name="*$emp_name$*" managedBy="$managedBy$" emp_status="$emp_status$" emp_type="$emp_type$" Days_Latest_Access &gt;= $Days_Latest_Access1$ Days_Latest_Access &lt;= $Days_Latest_Access2$ emp_dep="$emp_dep$" emp_lob="$emp_lob$" emp_ttl="$emp_ttl$" emp_cc="$emp_cc$" work_city="$work_city$" work_region="$work_region$" work_country="$work_country$" Splunk_Roles="$Splunk_Roles$" Splunk_Instance="$Splunk_Instance$" User="*$User$*" Login_Source="*$Login_Source$*"  splunk_role_map="$splunk_role_map$" ldap_group_name="$ldap_group_name$" ldap_group_type="$ldap_group_type$"</query>
  </search>
  <search id="splunk_sh_05_audit_users_dashboard_v1_2">
    <query>index=`gmc_setup_summary_index` search_name=splunk_audit_user_login_idx_summary_tracker
| fields _time User Splunk_Instance Login_Source OS_Name OS_Version Browser_Name Browser_Version 
| foreach Splunk_Instance Login_Source OS_Name OS_Version Browser_Name Browser_Version 
    [ makemv delim="|" &lt;&lt;FIELD&gt;&gt; ]
| `get_shcluster_label(Splunk_Instance)`
| fillnull value="undefined" OS_Name OS_Version Browser_Name Browser_Version
| search shcluster_label="$shcluster_label2$" User="$User2$" OS_Name="$OS_Name_tok$" OS_Version="$OS_Version_tok$" Browser_Name="$Browser_Name_tok$" Browser_Version="$Browser_Version_tok$"</query>
    <earliest>$TimeRangePkr.earliest$</earliest>
    <latest>$TimeRangePkr.latest$</latest>
  </search>
  <fieldset submitButton="false" autoRun="true"></fieldset>
  <row>
    <panel id="panel_accordion_togglepanel_false_0" depends="$gadget_lib_loaded$">
      <title>1. User Logon Activity Table &amp; Filters (From KV Store Tracking)</title>
      <input type="dropdown" token="shcluster_label" searchWhenChanged="true">
        <label>1. Splunk SH (Cluster/Instance)</label>
        <fieldForLabel>shcluster_label</fieldForLabel>
        <fieldForValue>shcluster_label</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by shcluster_label</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Roles" searchWhenChanged="true">
        <label>2. Splunk Roles</label>
        <fieldForLabel>Splunk_Roles</fieldForLabel>
        <fieldForValue>Splunk_Roles</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Splunk_Roles</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Splunk_Instance" searchWhenChanged="true">
        <label>3. Splunk Instance</label>
        <fieldForLabel>Splunk_Instance</fieldForLabel>
        <fieldForValue>Splunk_Instance</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Splunk_Instance</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="User" searchWhenChanged="true">
        <label>4. Identity (User)</label>
        <fieldForLabel>User</fieldForLabel>
        <fieldForValue>User</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by User</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="User" searchWhenChanged="true">
        <label>5. Identity (User) (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_name" searchWhenChanged="true">
        <label>6. Full Name</label>
        <fieldForLabel>emp_name</fieldForLabel>
        <fieldForValue>emp_name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_name</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="emp_name" searchWhenChanged="true">
        <label>7. Full Name (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Login_Source" searchWhenChanged="true">
        <label>8. Login Source</label>
        <fieldForLabel>Login_Source</fieldForLabel>
        <fieldForValue>Login_Source</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Login_Source</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="Login_Source" searchWhenChanged="true">
        <label>9. Login Source (contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_dep" searchWhenChanged="true">
        <label>10. Employee Department</label>
        <fieldForLabel>emp_dep</fieldForLabel>
        <fieldForValue>emp_dep</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_dep</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_lob" searchWhenChanged="true">
        <label>11. Line of Business</label>
        <fieldForLabel>emp_lob</fieldForLabel>
        <fieldForValue>emp_lob</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_cc" searchWhenChanged="true">
        <label>12. Cost Center</label>
        <fieldForLabel>emp_cc</fieldForLabel>
        <fieldForValue>emp_cc</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_cc</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_type" searchWhenChanged="true">
        <label>13. Employee Type</label>
        <fieldForLabel>emp_type</fieldForLabel>
        <fieldForValue>emp_type</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_type</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_status" searchWhenChanged="true">
        <label>14. Employee Status</label>
        <fieldForLabel>emp_status</fieldForLabel>
        <fieldForValue>emp_status</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_status</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="managedBy" searchWhenChanged="true">
        <label>15. Manager Name</label>
        <fieldForLabel>managedBy</fieldForLabel>
        <fieldForValue>managedBy</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by managedBy</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="emp_ttl" searchWhenChanged="true">
        <label>16. Employee Title</label>
        <fieldForLabel>emp_ttl</fieldForLabel>
        <fieldForValue>emp_ttl</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_ttl</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_city" searchWhenChanged="true">
        <label>17. City</label>
        <fieldForLabel>work_city</fieldForLabel>
        <fieldForValue>work_city</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_city</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_region" searchWhenChanged="true">
        <label>18. Region</label>
        <fieldForLabel>work_region</fieldForLabel>
        <fieldForValue>work_region</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_region</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="work_country" searchWhenChanged="true">
        <label>19.  Country</label>
        <fieldForLabel>work_country</fieldForLabel>
        <fieldForValue>work_country</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_country</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Days_Latest_Access2" searchWhenChanged="true">
        <label>20. Days Since Latest Access (Less Than or Equal)</label>
        <fieldForLabel>Days_Latest_Access_Display</fieldForLabel>
        <fieldForValue>Days_Latest_Access</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Days_Latest_Access 
| sort Days_Latest_Access
| `get_latest_access_human(Days_Latest_Access)`</query>
        </search>
        <choice value="9999999">Any</choice>
        <default>9999999</default>
        <initialValue>9999999</initialValue>
      </input>
      <input type="dropdown" token="Days_Latest_Access1" searchWhenChanged="true">
        <label>21. Days Since Latest Access (More Than or Equal)</label>
        <fieldForLabel>Days_Latest_Access_Display</fieldForLabel>
        <fieldForValue>Days_Latest_Access</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by Days_Latest_Access 
| sort Days_Latest_Access
| `get_latest_access_human(Days_Latest_Access)`</query>
        </search>
        <choice value="-1">Any</choice>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="dropdown" token="splunk_role_map" searchWhenChanged="true">
        <label>22. Splunk Role Maping</label>
        <choice value="*">All</choice>
        <fieldForLabel>splunk_role_map</fieldForLabel>
        <fieldForValue>splunk_role_map</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by splunk_role_map</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="ldap_group_name" searchWhenChanged="true">
        <label>23. LDAP Group Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>ldap_group_name</fieldForLabel>
        <fieldForValue>ldap_group_name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by ldap_group_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="ldap_group_type" searchWhenChanged="true">
        <label>24. LDAP Group Type</label>
        <choice value="*">All</choice>
        <fieldForLabel>ldap_group_type</fieldForLabel>
        <fieldForValue>ldap_group_type</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by ldap_group_type</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <table depends="$Login_Source$,$emp_dep$,$emp_lob$,$User$,$work_city$,$work_region$,$work_country$,$emp_type$">
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| `get_latest_access_human(Days_Latest_Access)` 
| table User emp_name emp_ttl shcluster_label Login_Source Latest_Access Days_Latest_Access_Display Earliest_Access Days_Since_Earliest_Login emp_type emp_status emp_lob emp_dep emp_cc managedBy work_city work_region work_country OS_Name OS_Version Browser_Name Browser_Version
| sort 0 - Latest_Access
| `rename_common_fields` 
| `rename_identity_fields`</query>
        </search>
        <option name="count">7</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">false</option>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Login_Source">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Login_Source_Resolved">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="First Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Last Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Days Since Last Login">
          <option name="precision">0</option>
          <option name="unit">Days</option>
        </format>
        <format type="color" field="Days Since Last Login">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="City">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User Job Title">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User City">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Days_Latest_Access_Display">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User Employment Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User Country">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <unset token="form.Login_Source"></unset>
          <unset token="form.emp_dep"></unset>
          <unset token="form.emp_lob"></unset>
          <unset token="form.User"></unset>
          <unset token="form.work_city"></unset>
          <unset token="form.work_region"></unset>
          <unset token="form.work_country"></unset>
          <unset token="form.emp_type"></unset>
        </drilldown>
      </table>
      <single>
        <title>Total Number of Users Accessing the Platform</title>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="height">50</option>
        <option name="rangeColors">["0x53a051","0x006d9c"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">none</option>
        <option name="unit">Users</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_2" depends="$gadget_lib_loaded$">
      <title>2. Drilldown By Employee</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by User| fields - count</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="emp_cc">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="emp_cc">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="count">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.User">$row.User$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_4" depends="$gadget_lib_loaded$">
      <title>3. Drilldown By Employee Type</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_type| fields - count</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <format type="color" field="emp_type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.emp_type">$row.emp_type$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_5" depends="$gadget_lib_loaded$">
      <title>4. Drilldown By Employee LOB</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_lob| fields - count
| where emp_lob!="Undefined"</query>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <format type="color" field="emp_lob">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.emp_lob">$row.emp_lob$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_false_6" depends="$gadget_lib_loaded$">
      <title>5. Drilldown By  Employee Department</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by emp_dep| fields - count
| where emp_dep!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="emp_dep">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="count">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Rank">
          <colorPalette type="minMidMax" maxColor="#5A4575" midColor="#FFFFFF" minColor="#708794"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Employee Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.emp_dep">$row.emp_dep$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_7" depends="$gadget_lib_loaded$">
      <title>6. Drilldown By Login Source (Client IP)</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats last(City) AS City last(Region) AS Region last(Country) AS Country by Login_Source 
| where Login_Source!="unknown" AND Login_Source!=""</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">true</option>
        <option name="wrap">false</option>
        <format type="color" field="Login Sources">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="# of Login Sources">
          <option name="precision">0</option>
        </format>
        <format type="color" field="# of Login Sources">
          <colorPalette type="minMidMax" maxColor="#B6C75A" midColor="#FFFFFF" minColor="#294E70"></colorPalette>
          <scale type="minMidMax" midType="percentile" midValue="50"></scale>
        </format>
        <format type="color" field="Login_Source">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.Login_Source">$row.Login_Source$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_8" depends="$gadget_lib_loaded$">
      <title>7. Drilldown By Employee City</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_city
| fields - count
| where work_city!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <format type="color" field="work_city">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.work_city">$row.work_city$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_9" depends="$gadget_lib_loaded$">
      <title>8. Drilldown By Employee Region/State</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_region| fields - count
| where work_region!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <format type="color" field="work_region">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.work_region">$row.work_region$</set>
        </drilldown>
      </table>
    </panel>
    <panel id="panel_accordion_togglepanel_true_10" depends="$gadget_lib_loaded$">
      <title>9. Drilldown By Employee Country</title>
      <table>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| stats count by work_country| fields - count
| where work_country!="Undefined"</query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <format type="color" field="work_country">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <drilldown>
          <set token="form.work_country">$row.work_country$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_false_12" depends="$gadget_lib_loaded$">
      <title>10. User Login Over Time (From Summary Indexing Tracking)</title>
      <input type="dropdown" token="shcluster_label2" searchWhenChanged="true">
        <label>1. Splunk SH (Cluster/Instance)</label>
        <fieldForLabel>shcluster_label</fieldForLabel>
        <fieldForValue>shcluster_label</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by shcluster_label</query>
        </search>
        <choice value="*">All</choice>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="time" token="TimeRangePkr" searchWhenChanged="true">
        <label>2. Time Range</label>
        <default>
          <earliest>-7d@h</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="span_period" searchWhenChanged="true">
        <label>3. Span Period</label>
        <default>span=1d</default>
        <choice value="">Automatic</choice>
        <choice value="span=1s">1 seconds</choice>
        <choice value="span=5s">5 seconds</choice>
        <choice value="span=10s">10 seconds</choice>
        <choice value="span=15s">15 seconds</choice>
        <choice value="span=30s">30 seconds</choice>
        <choice value="span=1m">1 minute</choice>
        <choice value="span=5m">5 minutes</choice>
        <choice value="span=10m">10 minutes</choice>
        <choice value="span=15m">15 minutes</choice>
        <choice value="span=30m">30 minutes</choice>
        <choice value="span=45m">45 minutes</choice>
        <choice value="span=1h">1 hour</choice>
        <choice value="span=2h">2 hours</choice>
        <choice value="span=3h">3 hours</choice>
        <choice value="span=4h">4 hours</choice>
        <choice value="span=6h">6 hours</choice>
        <choice value="span=8h">8 hours</choice>
        <choice value="span=12h">12 hours</choice>
        <choice value="span=1d">1 day</choice>
        <choice value="span=1w">1 week</choice>
        <choice value="span=1mon">1 month</choice>
        <choice value="span=12mon">1 year</choice>
        <initialValue>span=1d</initialValue>
      </input>
      <input type="dropdown" token="OS_Name_tok" searchWhenChanged="true">
        <label>4. OS Name</label>
        <fieldForLabel>OS_Name</fieldForLabel>
        <fieldForValue>OS_Name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by OS_Name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="OS_Version_tok" searchWhenChanged="true">
        <label>5. OS Version</label>
        <fieldForLabel>OS_Version</fieldForLabel>
        <fieldForValue>OS_Version</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by OS_Version</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Browser_Name_tok" searchWhenChanged="true">
        <label>6. Browser Name</label>
        <fieldForLabel>Browser_Name</fieldForLabel>
        <fieldForValue>Browser_Name</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by Browser_Name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Browser_Version_tok" searchWhenChanged="true">
        <label>7. Browser Version</label>
        <fieldForLabel>Browser_Version</fieldForLabel>
        <fieldForValue>Browser_Version</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by Browser_Version</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="User2" searchWhenChanged="true">
        <label>8. User</label>
        <fieldForLabel>User</fieldForLabel>
        <fieldForValue>User</fieldForValue>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| stats count by User</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
        <choice value="*">All</choice>
      </input>
      <input type="dropdown" token="split_by_tok_1" searchWhenChanged="true">
        <label>9. Split By</label>
        <choice value="By User">User</choice>
        <choice value="By OS_Name">OS Name</choice>
        <choice value="By Browser_Name">Browser Name</choice>
        <choice value="By shcluster_label">Search Cluster Label</choice>
        <choice value="By Splunk_Instance">Search Head</choice>
        <fieldForLabel>split_by_tok_1</fieldForLabel>
        <fieldForValue>split_by_tok_1</fieldForValue>
        <default>By shcluster_label</default>
        <initialValue>By shcluster_label</initialValue>
      </input>
      <input type="text" token="User2" searchWhenChanged="true">
        <label>10. User (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="top_tok" searchWhenChanged="true">
        <label>4. Timechart IN top:</label>
        <default>10</default>
        <initialValue>10</initialValue>
      </input>
      <chart>
        <search base="splunk_sh_05_audit_users_dashboard_v1_2">
          <query>| timechart useother=f usenull=f fixedrange=f limit=0 $span_period$
    Dc(User) As Num_Users $split_by_tok_1$ 
    Where Max in top$top_tok$</query>
        </search>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisY.abbreviation">auto</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="height">500</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_13" depends="$gadget_lib_loaded$">
      <title>11. Geographical Location by User rendered on a world map</title>
      <input type="dropdown" token="split_by_tok_2" searchWhenChanged="true">
        <label>Split By</label>
        <choice value="User">Identity</choice>
        <choice value="emp_name">Employee Name</choice>
        <fieldForLabel>split_by_tok_2</fieldForLabel>
        <fieldForValue>split_by_tok_2</fieldForValue>
        <default>emp_name</default>
        <initialValue>emp_name</initialValue>
      </input>
      <map>
        <search base="splunk_sh_05_audit_users_dashboard_v1">
          <query>| fields emp_name User work_city work_region work_country Login_Source work_lat work_long 
| mvexpand work_lat 
| mvexpand work_long 
| eval work_region = if(work_region="no-geo-info", work_country, work_region) 
| strcat $split_by_tok_2$ . " (" . work_city . ", " . work_region . ")" split_by 
| geostats latfield=work_lat longfield=work_long globallimit=0 locallimit=0 maxzoomlevel=18
    count by split_by</query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">1200</option>
        <option name="mapping.data.maxClusters">100</option>
        <option name="mapping.map.center">(41.64,-93.49)</option>
        <option name="mapping.map.zoom">4</option>
        <option name="mapping.markerLayer.markerMaxSize">50</option>
        <option name="mapping.markerLayer.markerMinSize">20</option>
        <option name="mapping.markerLayer.markerOpacity">1</option>
        <option name="mapping.showTiles">1</option>
        <option name="mapping.tileLayer.maxZoom">19</option>
        <option name="mapping.tileLayer.minZoom">0</option>
        <option name="mapping.tileLayer.url">http://mt1.google.com/vt/lyrs=y&amp;x={x}&amp;y={y}&amp;z={z}</option>
        <option name="mapping.type">marker</option>
        <option name="refresh.display">none</option>
      </map>
    </panel>
  </row>
  <row>
    <panel id="panel_accordion_togglepanel_true_3" depends="$gadget_lib_loaded$">
      <title>12. Associated GMC Job(s)</title>
      <html>
            <ol>
               <li>
                  GMC Jobs / GMC Gen Jobs /
                  <a href="/app/TA_global_monitoring_console/search?s=splunk_rest_identities_kv_store_lookup_gen" target="_blank" rel="noopener">GMC Identities Gen Job</a>
               </li>
               <li>
                  GMC Jobs / GMC Tracking Jobs /
                  <a href="/app/TA_global_monitoring_console/search?s=splunk_index_audit_user_login_tracker_sh_kv_store_lookup_tracker" target="_blank" rel="noopener">Track Users Activity (KV Store) (every 5 minutes)</a>
               </li>
               <li>
                  GMC Jobs / GMC Tracking Jobs /
                  <a href="/app/TA_global_monitoring_console/search?s=splunk_audit_user_login_idx_summary_tracker" target="_blank" rel="noopener">Track Users Activity (Summary Index) (every 5 minutes)</a>
               </li>
               <li>
                  GMC Jobs / GMC Gen Jobs / GMC Identities /
                  <a href="/app/TA_global_monitoring_console/search?s=splunk_identities_custom_sh_csv_gap_lookup_gen" target="_blank" rel="noopener">Append new users to Custom Identities Table</a>
               </li>
            </ol>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=admin&amp;namespace=TA_global_monitoring_console&amp;lookup=splunk_identities_custom_sh_csv.csv&amp;type=csv">
                     Edit Custom Identities
                     <i class="icon-data icon-modal-medium icon-color-searchfu m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-severe m-left"/>
                  </a>
               </div>
            </div>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=nobody&amp;namespace=TA_global_monitoring_console&amp;lookup=splunk_rest_identities_kv_store&amp;type=kv">
                     View Identities KV Store
                     <i class="icon-data icon-modal-medium icon-color-searchfu m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-severe m-left"/>
                  </a>
               </div>
            </div>
            <div class="btn-group1">
               <div id="mod_info">
                  <a class="btn middle contour" target="blank" href="/app/lookup_editor/lookup_edit?owner=nobody&amp;namespace=TA_global_monitoring_console&amp;lookup=splunk_index_audit_user_login_tracker_sh_kv_store&amp;type=kv">
                     View User Activity Tracker KV Store
                     <i class="icon-data icon-modal-medium icon-color-brandColorD40 m-left"/>
                  </a>
               </div>
               <div id="mod_att" class="hide">
                  <a class="btn full" href="javascript:();" data-toggle="modal" data-target="#info">
                     Attention
                     <i class="icon-alert icon-modal-medium icon-color-brandColorD40 m-left"/>
                  </a>
               </div>
            </div>
         </html>
    </panel>
  </row>
</form>